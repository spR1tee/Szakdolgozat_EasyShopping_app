#:include kivy_lang/swiper_item.kv
#:import MapView kivy_garden.mapview.MapView
#:import MapMarker kivy_garden.mapview.MapMarker

<NavigationScreen>:
    name: "nav"

    MDBottomNavigation:
        id: bottom_nav
        use_text: False

        MDBottomNavigationItem:
            name: "home"
            icon: "home"

            MDBoxLayout:
                orientation: "vertical"

                MDBoxLayout:
                    id: toolbar_container
                    orientation: "vertical"
                    size_hint_y: None
                    height: "130dp"
                    size_hint_x: None
                    width: root.width
                    spacing: "10dp"

                    MDTopAppBar:
                        id: toolbar
                        title: "Válassz kategóriát"
                        pos_hint: {'top': 1}

                    MDSwiper:
                        size_hint_y: None
                        height: "60dp"
                        on_swipe:
                            self.get_current_item().ids.icon.shake()
                            app.database.filter_shops(self.get_current_item().type)

                        MySwiper:
                            icon: "cart"
                            text: "Összes"
                            type: "all"

                        MySwiper:
                            icon: "food"
                            text: "Élelmiszer"
                            type: "food"

                        MySwiper:
                            icon: "laptop"
                            text: "Elektronika"
                            type: "electronics"

                        MySwiper:
                            icon: "tshirt-crew"
                            text: "Ruházat"
                            type: "clothing"

                MDBoxLayout:
                    id: search_container
                    padding: [dp(0), dp(10)]
                    adaptive_height: True

                ScrollView:
                    bar_width: 0
                    do_scroll_y: True

                    MDGridLayout:
                        id: shops_grid
                        adaptive_height: True
                        cols: 2
                        padding: [dp(15), dp(15), dp(15), dp(35)]
                        spacing: dp(15)



        MDBottomNavigationItem:
            name: "shopping_list"
            icon: "list-box"
            on_tab_press: app.controller.check_if_registered()

            MDFloatLayout:
                MDTopAppBar:
                    id: list_toolbar
                    title: "Bevásárlólista"
                    pos_hint: {'top': 1}
                    right_action_items: [["list-status"]]

                ScrollView:
                    pos_hint: {'center_y': .5, 'center_x': .5}
                    size_hint: .9, .8

                    MDList:
                        id: container


                MDFloatingActionButton:
                    icon: 'plus-thick'
                    on_release: app.controller.show_item_dialog()
                    elevation_normal: 12
                    pos_hint: {'x': .8, 'y':.05}

        MDBottomNavigationItem:
            name: "profile"
            icon: "map"
            on_tab_press: app.controller.check_if_registered()

            MDBoxLayout:
                orientation: "vertical"
                spacing: "10dp"

                MDTopAppBar:
                    id: map_toolbar
                    title: "Boltkereső"
                    pos_hint: {'top': 1}

                MDTextField:
                    id: search_shop_name
                    hint_text: "Bolt neve"
                    pos_hint: {'center_x': 0.5}
                    size_hint_x: None
                    width: "300dp"
                    icon_left: "cart"

                MDTextField:
                    id: search_radius
                    hint_text: "Mekkora körzetben keresel? (km)"
                    pos_hint: {'center_x': 0.5}
                    size_hint_x: None
                    width: "300dp"
                    icon_left: "map-marker-distance"

                MDFillRoundFlatIconButton:
                    text: "Keresés"
                    icon: "magnify"
                    font_name: "assets/fonts/Comfortaa-Regular.ttf"
                    size_hint: None, None
                    pos_hint: {'center_x': 0.5}
                    on_release: app.googlemaps.add_markers(search_radius.text, search_shop_name.text)

                ScrollView:
                    pos_hint: {'center_y': .5, 'center_x': .5}
                    size_hint: .9, .8
                    bar_width: 0
                    do_scroll_y: True

                    MDList:
                        id: places_container

                MapView:
                    id: mapview
                    lat: app.googlemaps.lat
                    lon: app.googlemaps.lon
                    zoom: 12
                    api_key: app.googlemaps.api_key

        MDBottomNavigationItem:
            name: "cards"
            icon: "credit-card"
            on_tab_press: app.controller.check_if_registered()

            MDFloatLayout:
                MDTopAppBar:
                    id: cards_toolbar
                    title: "Hűségkártyák"
                    pos_hint: {'top': 1}

                ScrollView:
                    pos_hint: {'center_y': .5, 'center_x': .5}
                    size_hint: .9, .8

                    MDList:
                        id: card_container

                MDFloatingActionButton:
                    icon: 'plus-thick'
                    on_release: app.controller.show_pic_dialog()
                    elevation_normal: 12
                    pos_hint: {'x': .8, 'y':.05}

        MDBottomNavigationItem:
            name: "favorites"
            icon: "heart"
            on_tab_press: app.controller.check_if_registered()

            MDBoxLayout:
                spacing: "10dp"
                orientation: "vertical"

                MDTopAppBar:
                    id: topappbar
                    title: "Kedvencek"
                    pos_hint: {'top': 1}

                MDSwiper:
                    size_hint_y: None
                    height: "60dp"
                    on_swipe:
                        self.get_current_item().ids.icon.shake()
                        app.database.filter_favorites(self.get_current_item().type)

                    MySwiper:
                        icon: "cart"
                        text: "Összes"
                        type: "all"

                    MySwiper:
                        icon: "food"
                        text: "Élelmiszer"
                        type: "food"

                    MySwiper:
                        icon: "laptop"
                        text: "Elektronika"
                        type: "electronics"

                    MySwiper:
                        icon: "tshirt-crew"
                        text: "Ruházat"
                        type: "clothing"

                ScrollView:
                    bar_width: 0
                    do_scroll_y: True

                    MDGridLayout:
                        id: favs_grid
                        adaptive_height: True
                        cols: 2
                        padding: [dp(15), dp(15), dp(15), dp(35)]
                        spacing: dp(15)